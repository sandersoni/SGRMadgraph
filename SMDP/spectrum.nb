(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     86727,       1896]
NotebookOptionsPosition[     84227,       1846]
NotebookOutlinePosition[     84560,       1861]
CellTagsIndexPosition[     84517,       1858]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"Directory", "[", "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"$spectruminputfile", "=", "\"\<spectruminput.mx\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nevents", "=", "10000"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "number", " ", "of", " ", "events", " ", "per", " ", "mg5", " ", "run"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"parameters", "=", 
   RowBox[{"Import", "[", "$spectruminputfile", "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"parameters", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<mxd\>\"", ",", 
        SuperscriptBox["10.", "5"], ",", 
        SuperscriptBox["10.", "5"], ",", "Null"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<gsm\>\"", ",", 
        SuperscriptBox["10.", 
         RowBox[{"-", "10"}]], ",", 
        SuperscriptBox["10.", 
         RowBox[{"-", "10"}]], ",", "Null"}], "}"}], ",", 
      RowBox[{"{", "\"\<adm\>\"", "}"}], ",", 
      RowBox[{"{", "\"\<mdvb\>\"", "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"parameters", " ", "to", " ", "be", " ", 
     RowBox[{"tracked", ".", " ", "First"}], " ", "two", " ", "have", " ", 
     "syntax", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<name\>\"", ",", " ", 
        RowBox[{"scan", " ", "start"}], ",", " ", 
        RowBox[{"scan", " ", "end"}], ",", " ", 
        RowBox[{"number", " ", "of", " ", "steps"}]}], "}"}], ".", " ", 
      "To"}], " ", "not", " ", "scan", " ", "set", " ", "start"}], " ", "=", 
    " ", 
    RowBox[{
     RowBox[{"end", " ", "and", " ", "steps"}], " ", "=", " ", "Null"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["10.", "par1"], ",", 
       SuperscriptBox["10.", "par2"], ",", 
       RowBox[{"0.024", 
        FractionBox[
         SuperscriptBox["10.", "par1"], "1000."]}], ",", "1."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"par1", ",", 
       RowBox[{"Log10", "[", 
        RowBox[{"parameters", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"Log10", "[", 
        RowBox[{"parameters", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
          
          RowBox[{"parameters", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], "-", 
           RowBox[{"Log10", "[", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
          RowBox[{
           RowBox[{"parameters", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "4"}], "\[RightDoubleBracket]"}], "-", "1."}]], 
         ",", "Null"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"par2", ",", 
       RowBox[{"Log10", "[", 
        RowBox[{"parameters", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"Log10", "[", 
        RowBox[{"parameters", "\[LeftDoubleBracket]", 
         RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"parameters", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
          
          RowBox[{"parameters", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}]}], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"Log10", "[", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "]"}], "-", 
           RowBox[{"Log10", "[", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "]"}]}], 
          RowBox[{
           RowBox[{"parameters", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "4"}], "\[RightDoubleBracket]"}], "-", "1."}]], 
         ",", "Null"}], "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Dimensions", "[", "intab", "]"}], "]"}], "\[Equal]", "3"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"intab", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"intab", ",", "1"}], "]"}]}]}], "]"}], 
   RowBox[{"(*", 
    RowBox[{
    "intab", " ", "is", " ", "the", " ", "table", " ", "of", " ", 
     "parameters", " ", "to", " ", "be", " ", "input", " ", "into", " ", 
     "madgraph", " ", "for", " ", "the", " ", 
     RowBox[{"scan", "."}]}], "*)"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "fixedform", " ", "is", " ", "what", " ", "makes", " ", "the", " ", 
    "numbers", " ", "nice", " ", "to", " ", "print", " ", "to", " ", "a", " ",
     "file"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StringPadLeft", "[", 
    RowBox[{"\"\<\>\"", ",", "1"}], "]"}], ";", 
   RowBox[{"(*", 
    RowBox[{
    "this", " ", "must", " ", "be", " ", "evaluated", " ", "first", " ", 
     "for", " ", "no", " ", "evident", " ", "reason"}], "*)"}], 
   RowBox[{
    RowBox[{"fixedform", "[", 
     RowBox[{"numd_", ",", "data_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ef", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"ef", "[", 
         RowBox[{"s_String", "/;", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"s", ",", "1"}], "]"}], "\[Equal]", "\"\<-\>\""}]}], 
         "]"}], ":=", 
        RowBox[{"\"\<-\>\"", "<>", 
         RowBox[{"StringPadLeft", "[", 
          RowBox[{
           RowBox[{"StringTake", "[", 
            RowBox[{"s", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "2", ",", 
           "\"\<0\>\""}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ef", "[", "s_String", "]"}], ":=", 
        RowBox[{"\"\<+\>\"", "<>", 
         RowBox[{"StringPadLeft", "[", 
          RowBox[{"s", ",", "2", ",", "\"\<0\>\""}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"NumberForm", "[", 
        RowBox[{"data", ",", 
         RowBox[{"{", 
          RowBox[{"numd", ",", "numd"}], "}"}], ",", 
         RowBox[{"ExponentFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"#", "&"}], ")"}]}], ",", 
         RowBox[{"NumberSigns", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<-\>\"", ",", "\"\< \>\""}], "}"}]}], ",", 
         RowBox[{"NumberFormat", "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StringPadRight", "[", 
                RowBox[{"#1", ",", 
                 RowBox[{"numd", "+", "2"}], ",", "\"\<0\>\""}], "]"}], ",", 
               "\"\<E\>\"", ",", 
               RowBox[{"ef", "[", "#3", "]"}]}], "}"}], "]"}], "&"}], 
           ")"}]}]}], "]"}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"hawc", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.5", ",", 
        RowBox[{"2.2", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.6", ",", 
        RowBox[{"8.8", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "13"}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5.0", ",", 
        RowBox[{"2.8", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "13"}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"15.7", ",", 
        RowBox[{"8.1", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "14"}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", 
        RowBox[{"6.3", " ", 
         SuperscriptBox["10", 
          RowBox[{"-", "14"}]]}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TeV", " ", "/", " ", 
       SuperscriptBox["cm", "2"]}], " ", "/", " ", "s"}], " ", "for", " ", 
     "each", " ", "bin"}], ",", " ", 
    RowBox[{
    "first", " ", "number", " ", "in", " ", "element", " ", "is", " ", "left",
      " ", "side", " ", "of", " ", "bin"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Do", "["}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$mg5outputfile", " ", "=", " ", "\"\<dvb\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$inputfile", "=", "\"\<anninput\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$mg5runfile", "=", "\"\<mg5run\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$pythiaoutputfile", "=", "\"\<pythiaoutput\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$pythonoutputfile", "=", "\"\<photonenergy\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$resultsfile", "=", 
   RowBox[{"\"\<eflux\>\"", "<>", 
    RowBox[{"ToString", "[", "$KernelID", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$debugfile", " ", "=", " ", 
   RowBox[{"\"\<debug\>\"", "<>", "$mg5outputfile"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"build", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"talpha", "=", "\"\<thermal\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"au", "=", 
   RowBox[{"1.49598", " ", 
    SuperscriptBox["10", "11"], " ", "*", "100"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "distance", " ", "from", " ", "earth", " ", "to", " ", "sun", " ", "in", 
    " ", "cm"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"aum", "=", 
   RowBox[{"1.49598", " ", 
    SuperscriptBox["10", "11"]}]}], " ", ";", 
  RowBox[{"(*", 
   RowBox[{
   "distance", " ", "from", " ", "earth", " ", "to", " ", "sun", " ", "in", 
    " ", "m"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"SR", "=", 
   RowBox[{"6.957", " ", 
    SuperscriptBox["10", "8"]}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"Solar", " ", "radius", " ", "in", " ", "m"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", "$debugfile", "]"}], ",", 
    RowBox[{"DeleteFile", "[", "$debugfile", "]"}]}], "]"}], ";"}]}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.767059435015987*^9, 3.767059440289794*^9}, {
   3.7670594739243937`*^9, 3.767059482623027*^9}, {3.767059530407789*^9, 
   3.767059532290553*^9}, {3.7670603083774967`*^9, 3.7670603328607597`*^9}, {
   3.76731676699936*^9, 3.7673168003476152`*^9}, {3.767317561800703*^9, 
   3.767317570717209*^9}, {3.7673194438782253`*^9, 3.767319447205084*^9}, {
   3.767319532580451*^9, 3.767319534204835*^9}, {3.7673196957598333`*^9, 
   3.767319748932729*^9}, {3.7673200640062113`*^9, 3.7673201161253843`*^9}, 
   3.767320222442473*^9, {3.767320295879653*^9, 3.76732029727913*^9}, {
   3.767320444071459*^9, 3.76732047695914*^9}, {3.767320549911902*^9, 
   3.76732057853693*^9}, 3.7673206351506987`*^9, {3.767320739120233*^9, 
   3.7673207415590353`*^9}, {3.767322812525043*^9, 3.767322947301765*^9}, {
   3.7673232290626163`*^9, 3.767323272031843*^9}, {3.767323342242508*^9, 
   3.767323358222*^9}, {3.767323407990279*^9, 3.7673234880308104`*^9}, {
   3.767323963527738*^9, 3.76732398497955*^9}, {3.767324143464755*^9, 
   3.767324149719186*^9}, {3.7673241974539957`*^9, 3.767324199398046*^9}, {
   3.767324510432824*^9, 3.7673245567301207`*^9}, {3.767324602615897*^9, 
   3.76732460527116*^9}, {3.767324636369856*^9, 3.767324681559924*^9}, {
   3.76732475399631*^9, 3.767324755566024*^9}, 3.767324788820804*^9, 
   3.7673248363877296`*^9, {3.7673249566013613`*^9, 3.767324972576192*^9}, {
   3.767325071936368*^9, 3.767325100851371*^9}, {3.767325918384062*^9, 
   3.7673260076879272`*^9}, {3.767326768372551*^9, 3.7673267694373627`*^9}, {
   3.767327356249857*^9, 3.767327375756652*^9}, {3.767327464562196*^9, 
   3.767327464993544*^9}, {3.767393346900003*^9, 3.767393346951827*^9}, 
   3.767393557506836*^9, {3.767394027162183*^9, 3.767394098307289*^9}, {
   3.767394290023032*^9, 3.767394358458981*^9}, {3.767394409425644*^9, 
   3.767394467989881*^9}, {3.767394500389504*^9, 3.767394502074479*^9}, {
   3.767394576152169*^9, 3.767394694089714*^9}, {3.767394751777059*^9, 
   3.767394752000132*^9}, {3.767394787275085*^9, 3.767394787535756*^9}, {
   3.767397235780583*^9, 3.767397235947319*^9}, {3.767397301894929*^9, 
   3.767397377000639*^9}, {3.7673974712055407`*^9, 3.7673974784021387`*^9}, {
   3.767397519862782*^9, 3.76739754424964*^9}, {3.7673988529221907`*^9, 
   3.7673988750285263`*^9}, {3.767398997956949*^9, 3.767399068921547*^9}, {
   3.7673991093746643`*^9, 3.7673991343374567`*^9}, {3.767399229966008*^9, 
   3.7673993152847233`*^9}, {3.7673993748084373`*^9, 3.76739938430394*^9}, {
   3.767399627053643*^9, 3.767399630225391*^9}, {3.767400271269252*^9, 
   3.767400271692045*^9}, {3.7674004983061037`*^9, 3.7674005332454233`*^9}, {
   3.767400622679367*^9, 3.767400644546536*^9}, {3.767405279515193*^9, 
   3.76740533444363*^9}, {3.767405581234398*^9, 3.76740558483554*^9}, {
   3.767405906180744*^9, 3.7674059126905413`*^9}, {3.767408877683463*^9, 
   3.767408878177577*^9}, {3.767408918907394*^9, 3.7674089257509336`*^9}, {
   3.767483908186223*^9, 3.767483910066448*^9}, 3.767488168088345*^9, {
   3.7676571255320187`*^9, 3.767657217894422*^9}, {3.767657259628615*^9, 
   3.767657302252696*^9}, {3.767657368141192*^9, 3.7676573832174473`*^9}, {
   3.767657832702034*^9, 3.767657852855198*^9}, {3.767658181240725*^9, 
   3.767658219320551*^9}, {3.767658314820437*^9, 3.76765840095575*^9}, {
   3.767659701405746*^9, 3.767659701674117*^9}, {3.767659889841758*^9, 
   3.767659893093712*^9}, {3.767660145220221*^9, 3.767660151862866*^9}, {
   3.767660234283917*^9, 3.7676602350124683`*^9}, {3.767660335278248*^9, 
   3.767660335763522*^9}, {3.767660388281444*^9, 3.7676604184728813`*^9}, {
   3.768089869155038*^9, 3.768089871337874*^9}, {3.768089961558989*^9, 
   3.768089990780032*^9}, {3.7680900812609653`*^9, 3.768090083910591*^9}, {
   3.768090153654604*^9, 3.768090202708643*^9}, {3.7680911694760237`*^9, 
   3.768091170974559*^9}, {3.768092487559889*^9, 3.7680925023881702`*^9}, {
   3.7680930183544397`*^9, 3.768093019103796*^9}, {3.7681021865121202`*^9, 
   3.768102270572277*^9}, {3.768102307397724*^9, 3.768102382650133*^9}, {
   3.768102418618092*^9, 3.7681024912365627`*^9}, {3.768104021991107*^9, 
   3.768104023055887*^9}, {3.76810442866*^9, 3.7681046275428667`*^9}, {
   3.768104674661236*^9, 3.768104875773391*^9}, {3.768104909150237*^9, 
   3.768104974545149*^9}, {3.7681050388915854`*^9, 3.768105039526581*^9}, {
   3.768164937009356*^9, 3.768165062795672*^9}, {3.768165781745516*^9, 
   3.7681657904131517`*^9}, {3.768166511715458*^9, 3.7681665363517714`*^9}, {
   3.768167213749188*^9, 3.768167215852418*^9}, {3.768614032402011*^9, 
   3.768614043309689*^9}, {3.768687054648222*^9, 3.768687069973711*^9}, {
   3.768687365587846*^9, 3.768687423667173*^9}, 3.768687456506318*^9, {
   3.768687518208867*^9, 3.768687602315213*^9}, {3.768687885536664*^9, 
   3.768687911970106*^9}, {3.768688231068779*^9, 3.768688231075172*^9}, 
   3.7686882816060047`*^9, 3.76868833261436*^9, {3.768688431234413*^9, 
   3.768688431379401*^9}, {3.768867694507318*^9, 3.768867694674225*^9}, {
   3.768867791112802*^9, 3.7688677912031527`*^9}, 3.768867831775918*^9, 
   3.768868103738948*^9, {3.76886928081509*^9, 3.768869280894751*^9}, 
   3.768870102508666*^9, {3.768871160905007*^9, 3.76887116180613*^9}, {
   3.768871331723001*^9, 3.7688713483718357`*^9}, {3.7688717386256323`*^9, 
   3.768871744769812*^9}, 3.7688719820930653`*^9, {3.768872215347761*^9, 
   3.768872215509389*^9}, {3.768872891105362*^9, 3.768872893092277*^9}, {
   3.768872932825309*^9, 3.7688729357923183`*^9}, {3.768873088763579*^9, 
   3.768873088966825*^9}, {3.768873180620029*^9, 3.768873181316486*^9}, 
   3.7688733030948563`*^9, {3.768873344301745*^9, 3.768873345765267*^9}, {
   3.769206878487134*^9, 3.7692068802187366`*^9}, {3.769216761626026*^9, 
   3.769216762765175*^9}, 3.769217041085539*^9, {3.769217414361364*^9, 
   3.769217418903583*^9}, {3.769217685607196*^9, 3.769217739339416*^9}, {
   3.76922102335506*^9, 3.769221025136032*^9}, {3.7692211737035627`*^9, 
   3.769221220770393*^9}, {3.7692220586686172`*^9, 3.769222060558422*^9}, {
   3.769222812830039*^9, 3.7692228276080313`*^9}, {3.76922288667794*^9, 
   3.769222921793676*^9}, {3.769225440257782*^9, 3.769225449571471*^9}, {
   3.769290945384543*^9, 3.769290945422558*^9}, {3.76929100467129*^9, 
   3.7692910186937447`*^9}, {3.7692947869899406`*^9, 
   3.7692947984443617`*^9}, {3.769305913278347*^9, 3.76930594288943*^9}, {
   3.769378437469309*^9, 3.76937845642459*^9}, {3.7693785093113813`*^9, 
   3.769378540974828*^9}, {3.769378764212702*^9, 3.769378770090107*^9}, {
   3.769378851918709*^9, 3.769378906978356*^9}, 3.769379542110797*^9, {
   3.7712036472394257`*^9, 3.7712036818175917`*^9}, {3.7712931384464293`*^9, 
   3.7712931396821947`*^9}, {3.771725524527519*^9, 3.771725534243305*^9}, {
   3.771893421960046*^9, 3.771893448601303*^9}, {3.77189717203928*^9, 
   3.771897189765465*^9}, {3.771897306924602*^9, 3.771897308579731*^9}, {
   3.7718973517247763`*^9, 3.771897354603036*^9}, {3.771897406748658*^9, 
   3.771897409796109*^9}, {3.771898631736054*^9, 3.7718986773565702`*^9}, {
   3.771905612376588*^9, 3.771905637152842*^9}, {3.7719120800136423`*^9, 
   3.771912100977326*^9}, {3.771912220332547*^9, 3.771912221363348*^9}, {
   3.771912302571083*^9, 3.771912316043483*^9}, {3.7719123786435137`*^9, 
   3.771912392079776*^9}, {3.7721560006437273`*^9, 3.772156006977395*^9}, {
   3.772156518422082*^9, 3.772156549343046*^9}, {3.772156593933569*^9, 
   3.7721566021510687`*^9}, {3.772334360782866*^9, 3.772334361131575*^9}, {
   3.7723344281738243`*^9, 3.7723344523858213`*^9}, {3.772334813352047*^9, 
   3.7723348145545473`*^9}, {3.772845413904482*^9, 3.772845420765316*^9}, {
   3.772931913982108*^9, 3.7729319322287483`*^9}, {3.7729319931527977`*^9, 
   3.772932024870659*^9}, {3.772932249464016*^9, 3.772932265927423*^9}, {
   3.7729335469311743`*^9, 3.772933563131877*^9}, {3.772933624559873*^9, 
   3.77293362557521*^9}, {3.772933717712442*^9, 3.7729337203891277`*^9}, {
   3.772933883348227*^9, 3.772933900756798*^9}, 3.77301152753461*^9, {
   3.7730116450109787`*^9, 3.773011645914755*^9}, {3.773012577394863*^9, 
   3.773012580306966*^9}, {3.773353210824552*^9, 3.7733532152545567`*^9}, {
   3.773360879685203*^9, 3.773360886182837*^9}, {3.773361990637518*^9, 
   3.7733619928891563`*^9}, {3.773370167499421*^9, 3.773370177272687*^9}, {
   3.7733702512211733`*^9, 3.773370262521955*^9}, {3.773541111354553*^9, 
   3.7735411150064373`*^9}, {3.7736987813120613`*^9, 3.773698805089164*^9}, {
   3.773698863278817*^9, 3.773698867740857*^9}, {3.7736989087239923`*^9, 
   3.773698909141224*^9}, {3.773700148872409*^9, 3.773700183214198*^9}, {
   3.773704499733707*^9, 3.773704500032806*^9}, {3.773704969572304*^9, 
   3.773704972325122*^9}, {3.774228337224148*^9, 3.774228346921463*^9}, {
   3.774228464468726*^9, 3.7742284843227377`*^9}, 3.774300463104273*^9, {
   3.7743009455976143`*^9, 3.7743009503812237`*^9}, 3.7743040983613043`*^9, {
   3.774315610744483*^9, 3.774315614120099*^9}, {3.774667158832408*^9, 
   3.774667163308667*^9}, 3.774667318652391*^9, 3.774667356732851*^9, 
   3.774667619270015*^9, 3.774667769093905*^9, {3.774668047342154*^9, 
   3.774668048571657*^9}, {3.7746680791167088`*^9, 3.774668079617584*^9}, {
   3.774668119714631*^9, 3.774668201001725*^9}, {3.774668723242546*^9, 
   3.774668723824067*^9}, {3.7746696185388803`*^9, 3.774669618997387*^9}, {
   3.774670190394788*^9, 3.774670190595858*^9}, {3.7746703687975283`*^9, 
   3.774670370546989*^9}, {3.7746704067316713`*^9, 3.7746704121655283`*^9}, {
   3.774672333547821*^9, 3.774672348780995*^9}, {3.774829490563221*^9, 
   3.774829498851687*^9}, {3.774829597790378*^9, 3.7748296166795673`*^9}, {
   3.7748296833273287`*^9, 3.774829689256432*^9}, {3.774830238178542*^9, 
   3.774830238630018*^9}, {3.774831575777013*^9, 3.7748315782646103`*^9}, {
   3.774831611843648*^9, 3.774831612708892*^9}, {3.774831684545992*^9, 
   3.774831690470594*^9}, 3.774833564115469*^9, {3.7748340064483232`*^9, 
   3.7748340137083483`*^9}, {3.775262170668067*^9, 3.7752621733027983`*^9}, {
   3.7752635377630167`*^9, 3.775263539786771*^9}, {3.7752640514303093`*^9, 
   3.775264056070825*^9}, {3.775265439593623*^9, 3.775265453441105*^9}, {
   3.775265648293736*^9, 3.775265650658422*^9}, {3.775266250014155*^9, 
   3.775266251656269*^9}, {3.775266872958786*^9, 3.775266873051229*^9}, {
   3.78441627796279*^9, 3.784416279222192*^9}, 3.784417970666147*^9, {
   3.784418605820635*^9, 3.784418606481916*^9}, 
   3.7844289036464577`*^9},ExpressionUUID->"bd3a6917-c163-4fef-bfea-\
4c9e4698f825"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"mxd\"\>", ",", "100000.`", ",", "100000.`", ",", "Null"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"gsm\"\>", ",", "1.`*^-9", ",", "1.`*^-9", ",", "Null"}], 
    "}"}], ",", 
   RowBox[{"{", "\<\"adm\"\>", "}"}], ",", 
   RowBox[{"{", "\<\"mdvb\"\>", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.772156602553176*^9, 3.77215720497614*^9, 3.7723339096414347`*^9, {
   3.7723344532767477`*^9, 3.77233445854767*^9}, 3.77284542821767*^9, 
   3.77284556532974*^9, 3.772931417222425*^9, 3.7729335658650017`*^9, {
   3.772933872982029*^9, 3.77293390107203*^9}, 3.7729342476750593`*^9, 
   3.772934285313892*^9, {3.773011524920165*^9, 3.773011527817753*^9}, 
   3.773011569600779*^9, {3.773011648155817*^9, 3.773011662142929*^9}, 
   3.773698818680879*^9, 3.773698881207272*^9, 3.773698916354562*^9, 
   3.774829529165773*^9, {3.774831594796246*^9, 3.774831619405127*^9}},
 CellLabel->"Out[3]=",ExpressionUUID->"45c4b3ae-098e-4717-8c4b-5d5b7acf61cd"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FileExistsQ", "[", 
     RowBox[{
     "\"\<pythia8_card_\>\"", "<>", "$mg5outputfile", "<>", "\"\<.dat\>\""}], 
     "]"}], ",", 
    RowBox[{"DeleteFile", "[", 
     RowBox[{
     "\"\<pythia8_card_\>\"", "<>", "$mg5outputfile", "<>", "\"\<.dat\>\""}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CopyFile", "[", 
   RowBox[{"\"\<pythia8_card_default.dat\>\"", ",", 
    RowBox[{
    "\"\<pythia8_card_\>\"", "<>", "$mg5outputfile", "<>", "\"\<.dat\>\""}]}],
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pythiacard", "=", 
   RowBox[{"OpenAppend", "[", 
    RowBox[{
     RowBox[{
     "\"\<pythia8_card_\>\"", "<>", "$mg5outputfile", "<>", "\"\<.dat\>\""}], 
     ",", 
     RowBox[{"PageWidth", "\[Rule]", " ", "500"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"pythiacard", ",", "\"\<ResonanceWidths:minWidth = 1e-30\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"pythiacard", ",", 
    RowBox[{"\"\<\\n\>\"", "<>", "\"\<Check:event = off\>\""}]}], "]"}], ";", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "This", " ", "enables", " ", "particles", " ", "with", " ", "very", " ", 
     "small", " ", "widths", " ", "to", " ", "still", " ", "decay", " ", "by",
      " ", "avoiding", " ", "their", " ", "width", " ", "being", " ", "set", 
     " ", "to", " ", "zero", " ", "for", " ", "being", " ", "below", " ", 
     "the", " ", "default", " ", "min", " ", "of", " ", "1", "e"}], "-", 
    "20"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "pythiacard", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.769216697763721*^9, 3.76921679386447*^9}, {
  3.769216847798918*^9, 3.769216923424336*^9}, {3.7692169711997538`*^9, 
  3.769217021424947*^9}, {3.769217368476697*^9, 3.769217395880928*^9}, {
  3.782772924936324*^9, 
  3.782772925234091*^9}},ExpressionUUID->"c1d64f98-a939-4d48-9322-\
369ba8ac9a70"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"intab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lmx", ",", "lma"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "lmx", ",", "lm\[Chi]start", ",", "lm\[Chi]end", ",", 
         "lm\[Chi]step"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"lma", ",", "lmAstart", ",", "lmAend", ",", "lmAstep"}], 
        "}"}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "ScanMadgraph", " ", "requires", " ", "a", " ", "list", " ", "of", " ", 
     "tuples", " ", "containing", " ", 
     RowBox[{"{", 
      RowBox[{"lm\[Chi]", ",", "lmA"}], "}"}], " ", "in", " ", "each", " ", 
     "entry"}], ",", " ", 
    RowBox[{"generated", " ", "above", " ", "by", " ", "intab"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ScanMadgraph", "[", "partable_", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "$mg5runfile", "]"}], ",", 
        RowBox[{"DeleteFile", "[", "$mg5runfile", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"DirectoryQ", "[", "$mg5outputfile", "]"}], ",", 
        RowBox[{"DeleteDirectory", "[", 
         RowBox[{"$mg5outputfile", ",", 
          RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"mg5run", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<import model ./SMDP_UFO/\>\"", ",", "\[IndentingNewLine]", " ", 
         "\"\<set automatic_html_opening False\>\"", ",", 
         "\[IndentingNewLine]", " ", "\"\<generate ~xd ~xd~ > dvb dvb\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<output \>\"", " ", "<>", " ", "$mg5outputfile"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<launch \>\"", "<>", "$mg5outputfile"}], ",", 
         "\[IndentingNewLine]", "\"\<shower = Pythia8\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<set nevents \>\"", "<>", 
          RowBox[{"ToString", "[", "nevents", "]"}]}], ",", 
         "\[IndentingNewLine]", "\"\<set WDVB Auto\>\"", ",", 
         "\[IndentingNewLine]", "\"\<set ptj 0.0\>\"", ",", 
         "\[IndentingNewLine]", "\"\<set pta 0.0\>\"", ",", 
         "\[IndentingNewLine]", "\"\<set ptl 0.0\>\"", ",", 
         "\[IndentingNewLine]", "\"\<set etaj -1.0\>\"", ",", 
         "\[IndentingNewLine]", "\"\<set etaa -1.0\>\"", ",", 
         "\[IndentingNewLine]", "\"\<set etal -1.0\>\"", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "\"\<./pythia8_card_\>\"", "<>", "$mg5outputfile", "<>", 
          "\"\<.dat\\n\>\""}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"$mg5runfile", ",", "mg5run", ",", "\"\<text\>\""}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"runfile", "=", 
       RowBox[{"OpenAppend", "[", 
        RowBox[{"$mg5runfile", ",", 
         RowBox[{"PageWidth", "\[Rule]", " ", "500"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"tab", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"partable", ",", "1"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", 
           RowBox[{"\"\<set \>\"", " ", "<>", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "<>", 
            "\"\< \>\"", "<>", " ", 
            RowBox[{"ToString", "[", 
             RowBox[{"fixedform", "[", 
              RowBox[{"6", ",", 
               RowBox[{"partable", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], 
             "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", 
           RowBox[{"\"\<set \>\"", "<>", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<>", 
            "\"\< \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"fixedform", "[", 
              RowBox[{"6", ",", 
               RowBox[{"partable", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}], 
             "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", 
           RowBox[{"\"\<set \>\"", "<>", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "<>", 
            "\"\< \>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", 
             RowBox[{"fixedform", "[", 
              RowBox[{"6", ",", 
               RowBox[{"partable", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}]}], "]"}], 
             "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", 
           RowBox[{"\"\<set \>\"", "<>", 
            RowBox[{"parameters", "\[LeftDoubleBracket]", 
             RowBox[{"4", ",", "1"}], "\[RightDoubleBracket]"}], "<>", 
            "\"\< \>\"", " ", "<>", " ", 
            RowBox[{"ToString", "[", 
             RowBox[{"fixedform", "[", 
              RowBox[{"6", ",", 
               RowBox[{"partable", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "4"}], "\[RightDoubleBracket]"}]}], "]"}], 
             "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", 
           RowBox[{"\"\<set ebeam1 \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"fixedform", "[", 
              RowBox[{"6", ",", 
               RowBox[{
                RowBox[{"partable", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
                "1.00001"}]}], "]"}], "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", 
           RowBox[{"\"\<set ebeam2 \>\"", "<>", 
            RowBox[{"ToString", "[", 
             RowBox[{"fixedform", "[", 
              RowBox[{"6", ",", 
               RowBox[{
                RowBox[{"partable", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "*", 
                "1.00001"}]}], "]"}], "]"}], "<>", "\"\<\\n\>\""}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"runfile", ",", "\"\<set WDVB Auto\\n\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[NotEqual]", 
            RowBox[{"Length", "[", "partable", "]"}]}], ",", 
           RowBox[{"WriteString", "[", 
            RowBox[{"runfile", ",", 
             RowBox[{
             "\"\<launch \>\"", "<>", "$mg5outputfile", "<>", 
              "\"\<\\n\>\""}]}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]",
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "partable", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "runfile", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Run", "[", 
       RowBox[{"\"\<mg5_aMC \>\"", "<>", "$mg5runfile"}], "]"}], ";"}], 
     ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ScanMadgraph", "[", "intab", "]"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.767059435015987*^9, 3.767059440289794*^9}, {
   3.7670594739243937`*^9, 3.767059482623027*^9}, {3.767059530407789*^9, 
   3.767059532290553*^9}, {3.7670603083774967`*^9, 3.7670603328607597`*^9}, {
   3.76731676699936*^9, 3.7673168003476152`*^9}, {3.767317561800703*^9, 
   3.767317570717209*^9}, {3.7673194438782253`*^9, 3.767319447205084*^9}, {
   3.767319532580451*^9, 3.767319534204835*^9}, {3.7673196957598333`*^9, 
   3.767319748932729*^9}, {3.7673200640062113`*^9, 3.7673201161253843`*^9}, 
   3.767320222442473*^9, {3.767320295879653*^9, 3.76732029727913*^9}, {
   3.767320444071459*^9, 3.76732047695914*^9}, {3.767320549911902*^9, 
   3.76732057853693*^9}, 3.7673206351506987`*^9, {3.767320739120233*^9, 
   3.7673207415590353`*^9}, {3.767322812525043*^9, 3.767322947301765*^9}, {
   3.7673232290626163`*^9, 3.767323272031843*^9}, {3.767323342242508*^9, 
   3.767323358222*^9}, {3.767323407990279*^9, 3.7673234880308104`*^9}, {
   3.767323963527738*^9, 3.76732398497955*^9}, {3.767324143464755*^9, 
   3.767324149719186*^9}, {3.7673241974539957`*^9, 3.767324199398046*^9}, {
   3.767324510432824*^9, 3.7673245567301207`*^9}, {3.767324602615897*^9, 
   3.76732460527116*^9}, {3.767324636369856*^9, 3.767324681559924*^9}, {
   3.76732475399631*^9, 3.767324755566024*^9}, 3.767324788820804*^9, 
   3.7673248363877296`*^9, {3.7673249566013613`*^9, 3.767324972576192*^9}, {
   3.767325071936368*^9, 3.767325100851371*^9}, {3.767325918384062*^9, 
   3.7673260076879272`*^9}, {3.767326768372551*^9, 3.7673267694373627`*^9}, {
   3.767327356249857*^9, 3.767327375756652*^9}, {3.767327464562196*^9, 
   3.767327464993544*^9}, {3.767393346900003*^9, 3.767393346951827*^9}, 
   3.767393557506836*^9, {3.767394027162183*^9, 3.767394098307289*^9}, {
   3.767394290023032*^9, 3.767394358458981*^9}, {3.767394409425644*^9, 
   3.767394467989881*^9}, {3.767394500389504*^9, 3.767394502074479*^9}, {
   3.767394576152169*^9, 3.767394694089714*^9}, {3.767394751777059*^9, 
   3.767394752000132*^9}, {3.767394787275085*^9, 3.767394787535756*^9}, {
   3.767397235780583*^9, 3.767397235947319*^9}, {3.767397301894929*^9, 
   3.767397377000639*^9}, {3.7673974712055407`*^9, 3.7673974784021387`*^9}, {
   3.767397519862782*^9, 3.76739754424964*^9}, {3.7673988529221907`*^9, 
   3.7673988750285263`*^9}, {3.767398997956949*^9, 3.767399068921547*^9}, {
   3.7673991093746643`*^9, 3.7673991343374567`*^9}, {3.767399229966008*^9, 
   3.7673993152847233`*^9}, {3.7673993748084373`*^9, 3.76739938430394*^9}, {
   3.767399627053643*^9, 3.767399630225391*^9}, {3.767400271269252*^9, 
   3.767400271692045*^9}, {3.7674004983061037`*^9, 3.7674005426903763`*^9}, {
   3.767400583923151*^9, 3.767400611634289*^9}, {3.7674006741178703`*^9, 
   3.7674006773571167`*^9}, {3.767401081866239*^9, 3.767401085396859*^9}, {
   3.767401121640389*^9, 3.767401130054763*^9}, {3.7674012038633423`*^9, 
   3.767401206716649*^9}, {3.767402052945928*^9, 3.767402066002859*^9}, {
   3.767402187444281*^9, 3.767402209317789*^9}, {3.767402549322917*^9, 
   3.767402626262389*^9}, {3.7674026815170183`*^9, 3.767402683015068*^9}, {
   3.767402875926729*^9, 3.767402880182529*^9}, {3.767402981901926*^9, 
   3.767402987322394*^9}, {3.767403041213655*^9, 3.7674030640067*^9}, {
   3.7674031371111813`*^9, 3.7674032924147987`*^9}, {3.767403372402602*^9, 
   3.7674034489963713`*^9}, {3.76740350664809*^9, 3.767403559957862*^9}, {
   3.767403727023114*^9, 3.767403846310638*^9}, {3.76740389427526*^9, 
   3.767403900185989*^9}, {3.767403959193651*^9, 3.7674039777829313`*^9}, {
   3.767405537747287*^9, 3.7674055898792677`*^9}, {3.767405628161859*^9, 
   3.767405665164525*^9}, {3.767405745049272*^9, 3.767405774302597*^9}, {
   3.7674058882757893`*^9, 3.7674058910503263`*^9}, {3.7674088071223927`*^9, 
   3.767408818735688*^9}, {3.767409006194824*^9, 3.767409019380324*^9}, {
   3.7676558238128557`*^9, 3.767655901796462*^9}, {3.767656061349547*^9, 
   3.767656065777956*^9}, 3.767658007668726*^9, {3.767658635090169*^9, 
   3.767658741536784*^9}, 3.767660325283228*^9, {3.768103438657525*^9, 
   3.76810347943215*^9}, {3.7681038989855127`*^9, 3.7681039033367987`*^9}, {
   3.768103970157692*^9, 3.768103986039918*^9}, 3.7681040464618063`*^9, {
   3.768165732197358*^9, 3.768165748650319*^9}, {3.7681660020197268`*^9, 
   3.768166108538074*^9}, {3.7681666665170317`*^9, 3.7681666733335323`*^9}, {
   3.768614066345199*^9, 3.768614092142612*^9}, {3.768687147680212*^9, 
   3.768687181921179*^9}, {3.768687220089699*^9, 3.768687247987426*^9}, {
   3.768687294157379*^9, 3.76868733443017*^9}, {3.768687610654595*^9, 
   3.768687612438195*^9}, 3.768867824295124*^9, {3.768871993280138*^9, 
   3.768872023796274*^9}, {3.768872380092999*^9, 3.7688723804727573`*^9}, {
   3.769217071532991*^9, 3.7692171765695353`*^9}, {3.7692172412675753`*^9, 
   3.76921724418927*^9}, {3.769222108503407*^9, 3.769222124482195*^9}, {
   3.769222983119471*^9, 3.769222983212522*^9}, {3.769225736428008*^9, 
   3.7692257437098837`*^9}, {3.769291048075151*^9, 3.769291053875946*^9}, {
   3.773534092228859*^9, 3.773534094293983*^9}, {3.7735352391754837`*^9, 
   3.773535239516184*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"f81457cf-540f-4fd6-8fbe-e0b7b50f8de7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"readparameter", "[", 
    RowBox[{"path_", ",", "name_"}], "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"fno", "=", 
      RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SetStreamPosition", "[", 
      RowBox[{"fno", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fnf", "=", 
      RowBox[{"Find", "[", 
       RowBox[{"fno", ",", 
        RowBox[{"\"\<# \>\"", "<>", "name"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringTake", "[", 
       RowBox[{"fnf", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"fnf", ",", 
              RowBox[{"\"\< # \>\"", "<>", "name"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "12"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringPosition", "[", 
             RowBox[{"fnf", ",", 
              RowBox[{"\"\< # \>\"", "<>", "name"}]}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"par", "=", 
      RowBox[{"ToExpression", "[", 
       RowBox[{"StringReplace", "[", 
        RowBox[{"str", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\"\<e+\>\"", "\[Rule]", " ", "\"\<*10^\>\""}], ",", 
           RowBox[{"\"\<e-\>\"", "\[Rule]", " ", "\"\<*10^-\>\""}]}], "}"}]}],
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Close", "[", "fno", "]"}], ";", "\[IndentingNewLine]", "par"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"readallparameters", "[", "path_", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"readparameter", "[", 
       RowBox[{"path", ",", 
        RowBox[{"parameters", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "parameters", "]"}]}], "}"}]}], "]"}], ")"}]}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"readallparameters", "[", 
    RowBox[{"fnb", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"readwidth", "[", 
   RowBox[{"path_", ",", "PDG_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"fno", "=", 
     RowBox[{"OpenRead", "[", "path", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"SetStreamPosition", "[", 
     RowBox[{"fno", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"fnf", "=", 
     RowBox[{"Find", "[", 
      RowBox[{"fno", ",", 
       RowBox[{"\"\<DECAY \>\"", "<>", "\"\< \>\"", "<>", "PDG"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"str", "=", 
     RowBox[{"StringTake", "[", 
      RowBox[{"fnf", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"fnf", ",", "PDG"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "4"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"StringPosition", "[", 
            RowBox[{"fnf", ",", "PDG"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "2"}], "]"}], "]"}], "+", "15"}]}], "}"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"width", "=", 
     RowBox[{"ToExpression", "[", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<e+\>\"", "\[Rule]", " ", "\"\<*10^\>\""}], ",", 
          RowBox[{"\"\<e-\>\"", "\[Rule]", " ", "\"\<*10^-\>\""}]}], "}"}]}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "fno", "]"}], ";", "\[IndentingNewLine]", "width"}],
    "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"readwidth", "[", 
    RowBox[{
    "\"\<dvb/Events/run_01/run_01_tag_1_banner.txt\>\"", ",", 
     "\"\<100001\>\""}], "]"}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.768100957158744*^9, 3.7681009650567303`*^9}, {
   3.768101004205554*^9, 3.768101295744432*^9}, {3.7681017125445747`*^9, 
   3.7681017129280863`*^9}, {3.768101778632008*^9, 3.768101794811554*^9}, {
   3.768102506802958*^9, 3.768102587046431*^9}, {3.7681026288485622`*^9, 
   3.768102733397634*^9}, {3.76810277755309*^9, 3.768102777614049*^9}, {
   3.7681656994158783`*^9, 3.768165703610979*^9}, 3.768166823325111*^9, {
   3.771293296784573*^9, 3.7712933375927896`*^9}, {3.771293369850472*^9, 
   3.77129342096555*^9}, {3.771293462097847*^9, 3.77129377560039*^9}, 
   3.771293854091654*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"4659c3bb-76d2-4cb7-8829-d708c404456d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"pythiaread", "[", "]"}], " ", "for", " ", "all", " ", "run", 
     " ", "folders", " ", "in", " ", "the", " ", "mg5outputfile", " ", 
     "reads", " ", "all", " ", "the", " ", "specified", " ", "parameters", 
     " ", "from", " ", "the", " ", "banners"}], ",", " ", 
    RowBox[{"then", " ", "decompresses", " ", "the", " ", "pythia", " ", 
     RowBox[{"events", ".", " ", "The"}], " ", "python", " ", "file", " ", 
     RowBox[{"read", ".", "py"}], " ", "then", " ", "reads", " ", "the", " ", 
     "pythia", " ", "files"}], ",", " ", 
    RowBox[{
    "and", " ", "extracts", " ", "the", " ", "photon", " ", "energy", " ", 
     "spectrum"}], ",", " ", 
    RowBox[{
    "which", " ", "is", " ", "appended", " ", "to", " ", "the", " ", 
     "results", " ", "file"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pythiaread", "[", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"fn", "=", 
       RowBox[{"FileNames", "[", 
        RowBox[{"All", ",", 
         RowBox[{"$mg5outputfile", "<>", "\"\</Events\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fnb", "=", "fn"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
         "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{
          "fn", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
          "<>", "\"\</\>\"", "<>", 
          RowBox[{"StringTake", "[", 
           RowBox[{
            RowBox[{
            "fn", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"StringPosition", "[", 
                RowBox[{
                 RowBox[{
                 "fn", "\[LeftDoubleBracket]", "fni", 
                  "\[RightDoubleBracket]"}], ",", "\"\<run_\>\""}], "]"}], 
               "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"StringLength", "[", 
               RowBox[{
               "fn", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}],
                "]"}]}], "}"}]}], "]"}], "<>", 
          "\"\<_tag_1_banner.txt\>\""}]}], ",", 
        RowBox[{"{", 
         RowBox[{"fni", ",", "1", ",", 
          RowBox[{"Length", "[", "fn", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "fnb", " ", "is", " ", "the", " ", "file", " ", "name", " ", "of", " ",
         "the", " ", "banner", " ", "for", " ", "run_fni"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"fno", "=", 
          RowBox[{"OpenRead", "[", 
           RowBox[{
           "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"m\[Chi]read", "=", 
          RowBox[{"readparameter", "[", 
           RowBox[{
            RowBox[{
            "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
            ",", "\"\<mxd\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mAread", "=", 
          RowBox[{"readparameter", "[", 
           RowBox[{
            RowBox[{
            "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
            ",", "\"\<mdvb\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"admread", "=", 
          RowBox[{"readparameter", "[", 
           RowBox[{
            RowBox[{
            "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
            ",", "\"\<adm\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"gsmread", "=", 
          RowBox[{"readparameter", "[", 
           RowBox[{
            RowBox[{
            "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
            ",", "\"\<gsm\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"widthread", "=", 
          RowBox[{"readwidth", "[", 
           RowBox[{
            RowBox[{
            "fnb", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
            ",", "\"\<100001\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"$pythiaoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ",", 
           RowBox[{"DeleteFile", "[", 
            RowBox[{"$pythiaoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Run", "[", 
          RowBox[{"\"\<gzip -d < \>\"", "<>", 
           RowBox[{
           "fn", "\[LeftDoubleBracket]", "fni", "\[RightDoubleBracket]"}], 
           "<>", "\"\</tag_1_pythia8_events.hepmc.gz > ./\>\"", "<>", 
           "$pythiaoutputfile", "<>", 
           RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", 
            RowBox[{"$pythonoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ",", 
           RowBox[{"DeleteFile", "[", 
            RowBox[{"$pythonoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Run", "[", 
          RowBox[{
          "\"\<python read.py \>\"", "<>", "$pythiaoutputfile", "<>", 
           RowBox[{"ToString", "[", "fni", "]"}], "<>", "\"\< \>\"", "<>", 
           "$pythonoutputfile", "<>", 
           RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"DeleteFile", "[", 
            RowBox[{"$pythiaoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"photonE", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Import", "[", 
            RowBox[{"$pythonoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"{", 
             RowBox[{
             "m\[Chi]read", ",", "mAread", ",", "admread", ",", "gsmread", 
              ",", "photonE"}], "}"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "[", "$inputfile", "]"}], ",", 
           RowBox[{"DeleteFile", "[", "$inputfile", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"input", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<build \>\"", "<>", 
             RowBox[{"ToString", "[", "build", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<mx \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"fixedform", "[", 
               RowBox[{"6", ",", "m\[Chi]read"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<mA \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"fixedform", "[", 
               RowBox[{"6", ",", "mAread"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<talpha \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"fixedform", "[", 
               RowBox[{"6", ",", "admread"}], "]"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<gsm \>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{"fixedform", "[", 
               RowBox[{"6", ",", "gsmread"}], "]"}], "]"}]}]}], 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"StringMatchQ", "[", 
               RowBox[{
                RowBox[{"ToString", "[", "talpha", "]"}], ",", 
                "\"\<thermal\>\""}], "]"}], ",", "talpha", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"fixedform", "[", 
                RowBox[{"6", ",", "talpha"}], "]"}], "]"}]}], "]"}], "*)"}], 
           "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{"$inputfile", ",", "input", ",", "\"\<text\>\""}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Run", "[", "\"\<math -run -noprompt < annrate.m\>\"", "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"annin", "=", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"\"\<ann\>\"", ",", "\"\<Table\>\""}], "]"}], "//", 
           "ToExpression"}]}], ";", "\n", 
         RowBox[{"annrate", "=", 
          RowBox[{"annin", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         RowBox[{"(*", 
          RowBox[{
          "DM", " ", "annihilation", " ", "rate", " ", "per", " ", "second"}],
           "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"sigmacm", "=", 
          RowBox[{"annin", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         RowBox[{"(*", 
          RowBox[{"DD", " ", "\[Sigma]", " ", "in", " ", 
           SuperscriptBox["cm", "2"]}], "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"taurat", "=", 
          RowBox[{"annin", "\[LeftDoubleBracket]", 
           RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}]}], 
         RowBox[{"(*", 
          RowBox[{
          "ratio", " ", "of", " ", "equilibrium", " ", "time", " ", "over", 
           " ", "lifetime", " ", "of", " ", "sun"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Tau]", "=", 
          RowBox[{
           FractionBox["\[HBar]", 
            RowBox[{"widthread", " ", 
             RowBox[{"(*", "GeV", "*)"}], " ", 
             SuperscriptBox["10", "9"], 
             RowBox[{"(*", 
              RowBox[{"eV", "/", "GeV"}], "*)"}], " "}]], "/.", 
           RowBox[{"{", 
            RowBox[{"\[HBar]", "\[Rule]", " ", 
             RowBox[{"4.135667662", " ", 
              SuperscriptBox["10", 
               RowBox[{"-", "15"}]]}]}], 
            RowBox[{"(*", 
             RowBox[{"eV", " ", "s"}], "*)"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Gamma]", "=", 
          FractionBox["m\[Chi]read", "mAread"]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"vel", "=", 
          RowBox[{
           RowBox[{"c", 
            SqrtBox[
             RowBox[{"1", "-", 
              FractionBox["1", 
               SuperscriptBox["\[Gamma]", "2"]]}]]}], "/.", 
           RowBox[{"{", 
            RowBox[{"c", "\[Rule]", " ", 
             RowBox[{"3", " ", 
              SuperscriptBox["10", "8"]}]}], 
            RowBox[{"(*", 
             RowBox[{"m", "/", "s"}], "*)"}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Pr", "[", "d_", "]"}], ":=", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "d"}], "/", 
            RowBox[{"(", " ", 
             RowBox[{"vel", " ", "\[Gamma]", " ", "\[Tau]"}], " ", ")"}]}], 
           "]"}]}], 
         RowBox[{"(*", 
          RowBox[{
          "Probability", " ", "it", " ", "has", " ", "survived", " ", "by", 
           " ", "distance", " ", "d"}], "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Prdetect", "=", 
          RowBox[{
           RowBox[{"Pr", "[", "SR", "]"}], "-", 
           RowBox[{"Pr", "[", "aum", "]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{
          "How", " ", "many", " ", "decay", " ", "between", " ", "the", " ", 
           "surface", " ", "of", " ", "the", " ", "sun", " ", "and", " ", 
           "the", " ", "distance", " ", "to", " ", "earth"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eflux", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             FractionBox[
              RowBox[{"photonE", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "nevents"], "*", "annrate", 
             " ", 
             FractionBox["1", 
              RowBox[{"4", "\[Pi]", " ", 
               SuperscriptBox["au", "2"]}]], "Prdetect"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "photonE", "]"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"outlist", "=", 
          RowBox[{"{", 
           RowBox[{
           "m\[Chi]read", ",", "mAread", ",", "admread", ",", "gsmread", ",", 
            "annrate", ",", "eflux", ",", "sigmacm", ",", "taurat", ",", 
            "widthread"}], "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", "outlist", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"results", "=", 
          RowBox[{"OpenAppend", "[", 
           RowBox[{"$resultsfile", ",", 
            RowBox[{"PageWidth", "\[Rule]", " ", "500"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Write", "[", 
          RowBox[{"results", ",", "outlist"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Close", "[", "results", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"DeleteFile", "[", 
            RowBox[{"$pythiaoutputfile", "<>", 
             RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"DeleteFile", "[", 
          RowBox[{"$pythonoutputfile", "<>", 
           RowBox[{"ToString", "[", "fni", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"admread", ">", "1"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Warning: Dark photon - DM fine structure constant of \>\"",
                ",", "admread", ",", "\"\< exceeding perturbativity\>\""}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Warning", " ", "outputs"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"dbo", "=", 
              RowBox[{"OpenAppend", "[", 
               RowBox[{"$debugfile", ",", 
                RowBox[{"PageWidth", "\[Rule]", " ", "1000"}]}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"Write", "[", 
              RowBox[{"dbo", ",", "\"\<adm > 1: \>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Write", "[", 
              RowBox[{"dbo", ",", "outlist"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Close", "[", "dbo", "]"}], ";"}], ")"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"taurat", ">", "1"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<Warning: Equilibrium time greater than sun lifetime, ratio \
is: \>\"", ",", "taurat"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"Warning", " ", "outputs"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"dbo", "=", 
              RowBox[{"OpenAppend", "[", 
               RowBox[{"$debugfile", ",", 
                RowBox[{"PageWidth", "\[Rule]", " ", "1000"}]}], "]"}]}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"Write", "[", 
              RowBox[{"dbo", ",", "\"\<tauratio > 1: \>\""}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Write", "[", 
              RowBox[{"dbo", ",", "outlist"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Close", "[", "dbo", "]"}], ";"}], ")"}]}], "]"}], ";"}],
         "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"fni", ",", "1", ",", 
          RowBox[{"Length", "[", "fn", "]"}]}], "}"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"pythiaread", "[", "]"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7674841938225307`*^9, 3.767484237266863*^9}, {
   3.76748427755158*^9, 3.7674843055688467`*^9}, {3.767484339625333*^9, 
   3.7674843406086397`*^9}, {3.767484379295261*^9, 3.7674845121712503`*^9}, {
   3.76748475124261*^9, 3.767484752421935*^9}, {3.7674849564082127`*^9, 
   3.7674849854093657`*^9}, {3.767485032760666*^9, 3.767485082426841*^9}, {
   3.767485129981464*^9, 3.7674854765780153`*^9}, {3.767485532841654*^9, 
   3.767485591078581*^9}, {3.767485622913931*^9, 3.767485691907716*^9}, {
   3.7674857639828873`*^9, 3.767485796446567*^9}, {3.767485909694013*^9, 
   3.767485931706847*^9}, {3.767486057166729*^9, 3.767486143398527*^9}, {
   3.767487324470604*^9, 3.767487336852138*^9}, {3.767487370436933*^9, 
   3.76748738478432*^9}, {3.7674874444782343`*^9, 3.767487485595973*^9}, {
   3.767487516758154*^9, 3.767487536937375*^9}, {3.76748762052129*^9, 
   3.7674876235699863`*^9}, {3.7674876694390287`*^9, 3.767488152135462*^9}, {
   3.767488411408167*^9, 3.7674885642760773`*^9}, {3.7674887447584248`*^9, 
   3.767488870334536*^9}, 3.767489071063485*^9, 3.7676585166683693`*^9, {
   3.767658571637491*^9, 3.7676586146056967`*^9}, {3.767658798014215*^9, 
   3.7676588597739553`*^9}, {3.7676589586074657`*^9, 3.767659059010325*^9}, {
   3.7676591415094233`*^9, 3.767659171030797*^9}, {3.767659218261195*^9, 
   3.767659221970257*^9}, {3.767659549118396*^9, 3.767659572257928*^9}, {
   3.767659670898365*^9, 3.767659853673802*^9}, 3.767659996397925*^9, {
   3.7680912335216417`*^9, 3.768091257764092*^9}, 3.768091304198037*^9, {
   3.768091542457531*^9, 3.768091551666802*^9}, {3.768091621128295*^9, 
   3.768091623709475*^9}, {3.768092583078764*^9, 3.768092593993043*^9}, {
   3.7680926366290607`*^9, 3.7680927272488003`*^9}, {3.768092855409148*^9, 
   3.76809293025029*^9}, {3.768092964775694*^9, 3.768092968090316*^9}, 
   3.768093087206005*^9, {3.76809313273612*^9, 3.7680931389690228`*^9}, {
   3.768093217020824*^9, 3.768093232556966*^9}, {3.768093375742659*^9, 
   3.768093386369824*^9}, {3.768093424777441*^9, 3.768093483086762*^9}, {
   3.768093521410026*^9, 3.768093617431665*^9}, {3.7680938935551453`*^9, 
   3.7680938959968*^9}, {3.7680939301767273`*^9, 3.768093996421733*^9}, {
   3.768094027365283*^9, 3.768094054365546*^9}, 3.768094092538707*^9, {
   3.768099915370769*^9, 3.7680999397732067`*^9}, {3.768099977854637*^9, 
   3.768099979161948*^9}, {3.768100890228266*^9, 3.7681009060245743`*^9}, {
   3.768101729167839*^9, 3.768101770475704*^9}, {3.7681018035318003`*^9, 
   3.7681018349333963`*^9}, {3.768101872170191*^9, 3.7681019480523653`*^9}, {
   3.768101988116804*^9, 3.7681020031685143`*^9}, {3.768103803379491*^9, 
   3.768103814593055*^9}, 3.768165100116786*^9, {3.768166449020944*^9, 
   3.7681664810106173`*^9}, {3.768166605889493*^9, 3.768166608400794*^9}, {
   3.768166869823818*^9, 3.7681669138399878`*^9}, {3.768167222008164*^9, 
   3.768167222193309*^9}, {3.768167740776011*^9, 3.76816775494252*^9}, {
   3.768613559420669*^9, 3.768613608653224*^9}, {3.768613864856196*^9, 
   3.768613866136404*^9}, {3.768693474368985*^9, 3.768693477397944*^9}, {
   3.7686982379437647`*^9, 3.768698256920773*^9}, {3.768867385959325*^9, 
   3.768867393152714*^9}, {3.7688674266453047`*^9, 3.768867466604788*^9}, {
   3.768867560061246*^9, 3.7688676570216722`*^9}, {3.768868040255918*^9, 
   3.768868047944487*^9}, {3.768871538708007*^9, 3.768871539493878*^9}, {
   3.7692212637799387`*^9, 3.769221400522415*^9}, {3.769222175324855*^9, 
   3.769222335595737*^9}, {3.769222378606553*^9, 3.769222381999137*^9}, {
   3.769222440511819*^9, 3.769222472929249*^9}, {3.769222521082192*^9, 
   3.769222548382416*^9}, {3.769222603849237*^9, 3.76922261969524*^9}, {
   3.771293795567994*^9, 3.771293848328227*^9}, {3.771293984919401*^9, 
   3.7712940158851213`*^9}, 3.771725302369994*^9, {3.771725557733406*^9, 
   3.771725636316839*^9}, {3.771893352903867*^9, 3.771893362647176*^9}, {
   3.7718972647533007`*^9, 3.771897276801457*^9}, {3.771897444700802*^9, 
   3.771897446251754*^9}, {3.7719122087672453`*^9, 3.7719122090619802`*^9}, {
   3.7721552001237297`*^9, 3.772155200409103*^9}, {3.7729329479262533`*^9, 
   3.7729329785397463`*^9}, 3.773011029773386*^9, {3.773011068713503*^9, 
   3.7730110709494543`*^9}, 3.773353202076668*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"fcbc698c-9253-4e7a-8455-49e75945367b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "section", " ", "actually", " ", "performs", " ", "the", 
      " ", "scan"}], ";", " ", 
     RowBox[{
     "it", " ", "will", " ", "generate", " ", "10", " ", "madgraphs", " ", 
      "at", " ", "a", " ", "time"}]}], ",", " ", 
    RowBox[{
    "then", " ", "read", " ", "them", " ", "and", " ", "delete", " ", 
     "them"}], ",", " ", 
    RowBox[{
    "to", " ", "avoid", " ", "filling", " ", "up", " ", "the", " ", 
     "computer", " ", "storage"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"finalscan", "[", "]"}], ":=", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FileExistsQ", "[", "$resultsfile", "]"}], ",", 
        RowBox[{"DeleteFile", "[", "$resultsfile", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lefttab", "=", "intab"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "lefttab", "]"}], ">", "10"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"scantab", "=", 
             RowBox[{"Take", "[", 
              RowBox[{"lefttab", ",", "10"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"lefttab", "=", 
             RowBox[{"Drop", "[", 
              RowBox[{"lefttab", ",", "10"}], "]"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"scantab", "=", "lefttab"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ScanMadgraph", "[", "scantab", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"pythiaread", "[", "]"}], ";"}], "\[IndentingNewLine]", ",", 
        
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "intab", "]"}], ",", "10"}], "}"}]}], 
       "]"}]}], "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
   RowBox[{"finalscan", "[", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.768867896546713*^9, 3.768867985281887*^9}, {
  3.7688681856483517`*^9, 3.768868186204893*^9}, {3.768868247293598*^9, 
  3.7688682829048347`*^9}, {3.768868315989711*^9, 3.768868319005416*^9}, {
  3.768868354136644*^9, 3.768868395864571*^9}, {3.768868451807973*^9, 
  3.768868459473462*^9}, {3.7688688002081213`*^9, 3.7688688081758823`*^9}, {
  3.7688688640779877`*^9, 3.768868879125108*^9}, {3.7688690323536158`*^9, 
  3.7688690391536417`*^9}, {3.768869174418119*^9, 3.768869263171485*^9}, {
  3.768870027364212*^9, 3.7688700518526917`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"2922660b-c89a-4813-a226-5bbe6d945c59"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100000.`", ",", "0.5`", ",", "2.4`", ",", "1.`*^-9", ",", 
   "1.4327544743022188`*^14", ",", 
   RowBox[{"{", 
    RowBox[{
    "3.1374476333858952`*^-12", ",", "9.451868321710802`*^-12", ",", 
     "2.305293607868497`*^-11", ",", "3.7358554542441794`*^-11", ",", 
     "1.2455519411680294`*^-11"}], "}"}], ",", "4.8294`*^-45", ",", 
   "0.0008572349696969811`", ",", "5.1911799999999996`*^-21"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.769217263007215*^9, 3.7692173167693367`*^9, 
  3.769217387283072*^9, 3.7692177894646606`*^9, 3.77129317280624*^9, 
  3.7717253465661697`*^9, 3.771725667543084*^9, 3.771897214021701*^9, 
  3.7718973311522627`*^9, 3.771897378239936*^9, 3.771897431810842*^9, 
  3.771897469628207*^9, 3.771912251990296*^9, 3.7719123478410807`*^9, 
  3.771912416058322*^9, 3.772151504440971*^9, 3.772155159961671*^9, 
  3.772155655183564*^9, 3.77215722667883*^9, 3.772333931332563*^9, 
  3.772334480003339*^9, 3.772845587965623*^9, 3.7729314407072163`*^9, 
  3.772933587546176*^9, 3.773698900988657*^9, 3.773698937609561*^9, 
  3.774829549870775*^9, 3.77483164373507*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"a6ee4ad9-4cac-4a44-850d-203e6f9deb76"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Warning: Dark photon - DM fine structure constant of \"\>", 
   "\[InvisibleSpace]", "2.4`", 
   "\[InvisibleSpace]", "\<\" exceeding perturbativity\"\>"}],
  SequenceForm[
  "Warning: Dark photon - DM fine structure constant of ", 2.4, 
   " exceeding perturbativity"],
  Editable->False]], "Print",
 CellChangeTimes->{3.769217263007215*^9, 3.7692173167693367`*^9, 
  3.769217387283072*^9, 3.7692177894646606`*^9, 3.77129317280624*^9, 
  3.7717253465661697`*^9, 3.771725667543084*^9, 3.771897214021701*^9, 
  3.7718973311522627`*^9, 3.771897378239936*^9, 3.771897431810842*^9, 
  3.771897469628207*^9, 3.771912251990296*^9, 3.7719123478410807`*^9, 
  3.771912416058322*^9, 3.772151504440971*^9, 3.772155159961671*^9, 
  3.772155655183564*^9, 3.77215722667883*^9, 3.772333931332563*^9, 
  3.772334480003339*^9, 3.772845587965623*^9, 3.7729314407072163`*^9, 
  3.772933587546176*^9, 3.773698900988657*^9, 3.773698937609561*^9, 
  3.774829549870775*^9, 3.774831643736932*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"908d4fd3-c907-428f-8f7e-3293eb7cd6af"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"aum", "=", 
    RowBox[{"1.49598", " ", 
     SuperscriptBox["10", "11"]}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "distance", " ", "from", " ", "earth", " ", "to", " ", "sun", " ", "in", 
    " ", "m"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"widthread", "=", 
   RowBox[{"8.05", "  ", 
    SuperscriptBox["10", 
     RowBox[{"-", "22"}]]}]}], 
  RowBox[{"(*", 
   RowBox[{
   "Decay", " ", "Width", " ", "of", " ", "dark", " ", "photon", " ", "in", 
    " ", "GeV"}], "*)"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SR", "=", 
    RowBox[{"6.957", " ", 
     SuperscriptBox["10", "8"]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Solar", " ", "radius"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m\[Chi]read", "=", "100000."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mAread", "=", "5."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Tau]", "=", 
   RowBox[{
    FractionBox["\[HBar]", 
     RowBox[{"widthread", " ", 
      SuperscriptBox["10", "9"], " "}]], "/.", 
    RowBox[{"{", 
     RowBox[{"\[HBar]", "\[Rule]", " ", 
      RowBox[{"4.135667662", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "15"}]]}]}], 
     RowBox[{"(*", 
      RowBox[{"eV", " ", "s"}], "*)"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Gamma]", "=", 
   FractionBox["m\[Chi]read", "mAread"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vel", "=", 
   RowBox[{
    RowBox[{"c", 
     SqrtBox[
      RowBox[{"1", "-", 
       FractionBox["1", 
        SuperscriptBox["\[Gamma]", "2"]]}]]}], "/.", 
    RowBox[{"{", 
     RowBox[{"c", "\[Rule]", " ", 
      RowBox[{"3", " ", 
       SuperscriptBox["10", "8"]}]}], 
     RowBox[{"(*", 
      RowBox[{"m", "/", "s"}], "*)"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pr", "[", "d_", "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", "d"}], "/", 
     RowBox[{"(", " ", 
      RowBox[{"vel", " ", "\[Gamma]", " ", "\[Tau]"}], " ", ")"}]}], "]"}]}], 
  
  RowBox[{"(*", 
   RowBox[{
   "Probability", " ", "it", " ", "has", " ", "survived", " ", "by", " ", 
    "distance", " ", "d"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Pric", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Pr", "[", "r", "]"}], 
    RowBox[{"HeavisideTheta", "[", 
     RowBox[{
      RowBox[{"d", "[", "\[Theta]", "]"}], "-", "r"}], "]"}]}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Probability", " ", "it", " ", "has", " ", "survived"}], ",", " ", 
    RowBox[{"but", " ", "outside", " ", "cone", " ", "is", " ", "zero"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deg", "[", "rad_", "]"}], ":=", 
  RowBox[{
   FractionBox["180.", "\[Pi]"], "rad"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rad", "[", "deg_", "]"}], ":=", 
  RowBox[{
   FractionBox["\[Pi]", "180."], "deg"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shadow", "=", 
   RowBox[{"deg", "[", 
    RowBox[{"ArcTan", "[", 
     FractionBox["SR", "aum"], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "\[Theta]_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[Theta]", "<", 
       RowBox[{"rad", "[", 
        RowBox[{"180", "-", "shadow"}], "]"}]}], ",", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Theta]", "<", 
         RowBox[{"rad", "[", "177", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", 
          RowBox[{"rad", "[", "3", "]"}], "]"}], 
         RowBox[{"(", 
          FractionBox["aum", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"rad", "[", "177", "]"}], " ", "-", " ", "\[Theta]"}], 
            "]"}]], ")"}]}], ",", "\[Infinity]"}], "]"}], ",", "0"}], "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"Distance", " ", "from", " ", "sun", " ", "to", " ", 
     RowBox[{"cone", ".", " ", "If"}], " ", "behind", " ", "the", " ", "sun", 
     " ", 
     RowBox[{"(", 
      RowBox[{"\[Theta]", "<", 
       RowBox[{"rad", "[", 
        RowBox[{"180", "-", "shadow"}], "]"}]}], ")"}], " ", "then", " ", "d",
      " ", "becomes", " ", "0", " ", 
     RowBox[{"i", ".", "e", ".", " ", "treated"}], " ", "as", " ", "always", 
     " ", "decayed", " ", "outside", " ", 
     RowBox[{"cone", "."}]}], "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dE2", "[", 
     RowBox[{"\[Theta]_", ",", "r_"}], "]"}], ":=", 
    RowBox[{
     SuperscriptBox["r", "2"], "+", 
     SuperscriptBox["au", "2"], "-", 
     RowBox[{"2", "r", " ", "au", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "distance", " ", "squared", " ", "to", " ", "earth", " ", "at", " ", 
    "\[Theta]", " ", "r"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Pr", "[", "SR", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Pr", "[", "aum", "]"}]}], "Input",
 CellChangeTimes->{
  3.7712073971974*^9, {3.7712940351140614`*^9, 3.771294124701621*^9}, {
   3.771294188860921*^9, 3.771294259570532*^9}, {3.7715446187563047`*^9, 
   3.77154471895527*^9}, {3.771544830778064*^9, 3.771544831127068*^9}, {
   3.771544955419196*^9, 3.7715449946788807`*^9}, {3.771546565152151*^9, 
   3.77154667231874*^9}, {3.7715467030637913`*^9, 3.77154673741079*^9}, {
   3.771546843817482*^9, 3.77154685548883*^9}, {3.771547411521345*^9, 
   3.771547443575179*^9}, {3.771547911668231*^9, 3.771547915609016*^9}, {
   3.7715480765774384`*^9, 3.771548121018291*^9}, {3.771549728776905*^9, 
   3.771549747991049*^9}, {3.771549779672161*^9, 3.7715499333599033`*^9}, {
   3.771549983590562*^9, 3.771550039776825*^9}, {3.7715500917447033`*^9, 
   3.771550147851458*^9}, {3.771550220035553*^9, 3.7715503799948053`*^9}, {
   3.771550521447414*^9, 3.7715505368442707`*^9}, {3.771550612001273*^9, 
   3.771550617713756*^9}, {3.771550648151341*^9, 3.771550676329751*^9}, {
   3.7715508006773*^9, 3.7715508330800257`*^9}, {3.771550925801257*^9, 
   3.7715509394448833`*^9}, {3.771551013966909*^9, 3.771551125118082*^9}, 
   3.771551181652924*^9, {3.7715512134901333`*^9, 3.77155136579784*^9}, {
   3.771551568251504*^9, 3.771551580462714*^9}, {3.77155162166789*^9, 
   3.771551679007815*^9}, {3.7715518016850967`*^9, 3.771551806200774*^9}, {
   3.7715519367701073`*^9, 3.771551961181574*^9}, {3.771552345949876*^9, 
   3.7715523613377037`*^9}, {3.771552699274518*^9, 3.771552704871945*^9}, {
   3.771552737866275*^9, 3.771552739080989*^9}, {3.7715577749704037`*^9, 
   3.7715578069387608`*^9}, {3.771557871690269*^9, 3.771557931089937*^9}, {
   3.771557975458227*^9, 3.7715579755745792`*^9}, {3.7715580851153383`*^9, 
   3.771558184595731*^9}, {3.771558318413444*^9, 3.77155836751969*^9}, {
   3.7715592876047783`*^9, 3.771559288094809*^9}, {3.771559320920086*^9, 
   3.7715593403860273`*^9}, {3.771560021467072*^9, 3.7715600755818043`*^9}, {
   3.771725429128725*^9, 3.771725483101388*^9}, {3.7718975077838583`*^9, 
   3.771897546513544*^9}, {3.7752655173642187`*^9, 3.775265623878661*^9}, {
   3.775265722187468*^9, 3.775265722543765*^9}, {3.784428943515218*^9, 
   3.784428951286899*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"275a486c-697d-43e9-ab2b-329ebe12e447"],

Cell[BoxData["0.9776833334033956`"], "Output",
 CellChangeTimes->{{3.775265527755147*^9, 3.775265624290461*^9}, 
   3.775265725658383*^9, {3.784428923958879*^9, 3.784428951622699*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"8c659ed4-30f2-4d6b-88df-d95ac9310e56"],

Cell[BoxData["0.0078036635335273115`"], "Output",
 CellChangeTimes->{{3.775265527755147*^9, 3.775265624290461*^9}, 
   3.775265725658383*^9, {3.784428923958879*^9, 3.784428951623839*^9}},
 CellLabel->"Out[51]=",ExpressionUUID->"ae704be1-c4b4-41d6-9b7e-ad05c0a65bef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"x", " ", 
     RowBox[{"Pr", "[", "x", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "SR", ",", "\[Infinity]"}], "}"}]}], "]"}], 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{"Pr", "[", "x", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "SR", ",", "\[Infinity]"}], "}"}]}], "]"}]]], "Input",
 CellChangeTimes->{{3.771552128286234*^9, 3.771552138753888*^9}, {
   3.771552201238031*^9, 3.771552207501897*^9}, {3.771552248681645*^9, 
   3.771552267219762*^9}, 3.771552449869746*^9, {3.771558274025457*^9, 
   3.7715583135579967`*^9}, {3.771558400866201*^9, 3.771558401008028*^9}, {
   3.7715591693470373`*^9, 3.771559173944531*^9}, {3.771559205230235*^9, 
   3.771559239146021*^9}, 3.771559272765409*^9, {3.7715601333952913`*^9, 
   3.7715601398414*^9}, {3.7715601724823*^9, 3.771560173316824*^9}},
 CellLabel->
  "In[1185]:=",ExpressionUUID->"9351ed12-7904-4feb-b19d-ff7c1d8647df"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"x\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"x\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"8.051219620768978`*^11\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"2.284782069309531`*^25\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"3.0952315410473385`*^24\\\"}]\\) for the integral and \
error estimates.\"",2,1185,60,18601034940636579559,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7715583063942547`*^9, 3.771558313884502*^9}, {
   3.771558379063815*^9, 3.77155840134846*^9}, {3.771559162769569*^9, 
   3.771559174584495*^9}, 3.771559209351548*^9, 3.771559239485299*^9, 
   3.7715592732399178`*^9, 3.771560173620306*^9},
 CellLabel->
  "During evaluation of \
In[1185]:=",ExpressionUUID->"b0d65828-b46b-4c51-9700-8b799a0cacce"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"x\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"x\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \\\"8.051219620768978`*^11\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"4.781170059849492`*^12\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"3.388794193483484`*^10\\\"}]\\) for the integral and \
error estimates.\"",2,1185,61,18601034940636579559,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7715583063942547`*^9, 3.771558313884502*^9}, {
   3.771558379063815*^9, 3.77155840134846*^9}, {3.771559162769569*^9, 
   3.771559174584495*^9}, 3.771559209351548*^9, 3.771559239485299*^9, 
   3.7715592732399178`*^9, 3.771560173633214*^9},
 CellLabel->
  "During evaluation of \
In[1185]:=",ExpressionUUID->"d5c9770e-a786-429a-8138-8630317d8c75"],

Cell[BoxData["4.77870906223623`*^12"], "Output",
 CellChangeTimes->{
  3.771552139361575*^9, {3.77155220404986*^9, 3.771552207753684*^9}, {
   3.771558230724484*^9, 3.771558231975469*^9}, {3.771558306402891*^9, 
   3.771558313903926*^9}, {3.7715583790804033`*^9, 3.7715584013608294`*^9}, {
   3.771559162782414*^9, 3.771559174598344*^9}, 3.771559209363657*^9, 
   3.771559239500114*^9, 3.771559273253187*^9, 3.771560173634121*^9},
 CellLabel->
  "Out[1185]=",ExpressionUUID->"680cbf3c-64ec-488c-808a-4fd1c36f281d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 FractionBox[
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Pr", "[", "r", "]"}], "2", "\[Pi]", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
     SuperscriptBox["r", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "SR", ",", "\[Infinity]"}], "}"}]}], "]"}], 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Pr", "[", "r", "]"}], "4", "\[Pi]", " ", 
     SuperscriptBox["r", "2"]}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "SR", ",", "\[Infinity]"}], "}"}], ",", 
    RowBox[{"WorkingPrecision", "\[Rule]", " ", "50"}]}], "]"}]]], "Input",
 CellChangeTimes->{{3.771560181851199*^9, 3.771560229335092*^9}, {
  3.7715602711102533`*^9, 3.7715603251828938`*^9}, {3.771560418219234*^9, 
  3.7715604192851543`*^9}, {3.7715604601515903`*^9, 3.771560559870228*^9}},
 CellLabel->
  "In[1200]:=",ExpressionUUID->"e31cc252-d4d5-4800-ba90-7f83c28bea11"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","precw",
   "\"The precision of the argument function (\\!\\(\\*RowBox[{\\\"4\\\", \
\\\" \\\", SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"2.0920362499801897`*^-13\\\"}], \\\" \\\", \\\"r\\\"}]], \\\" \\\", \\\"\
\[Pi]\\\", \\\" \\\", SuperscriptBox[\\\"r\\\", \\\"2\\\"]}]\\)) is less than \
WorkingPrecision (\\!\\(\\*RowBox[{\\\"50.`\\\"}]\\)).\"",2,1200,86,
   18601034940636579559,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7715604845694313`*^9, 3.771560560187951*^9}},
 CellLabel->
  "During evaluation of \
In[1200]:=",ExpressionUUID->"916a6389-fd42-4afe-9ff1-06dabfeab836"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","ncvb",
   "\"NIntegrate failed to converge to prescribed accuracy after \
\\!\\(\\*RowBox[{\\\"9\\\"}]\\) recursive bisections in \
\\!\\(\\*RowBox[{\\\"r\\\"}]\\) near \\!\\(\\*RowBox[{\\\"{\\\", \\\"r\\\", \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"7.7644634692211361984621372289120625659373274374991`50.*^11\\\", \
\\\"}\\\"}]\\). NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"2.744936126308024620781589728103224991730032004184`50.*^\
39\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"3.2698096017761747003342676764920080237268041339354`50.*^\
35\\\"}]\\) for the integral and error estimates.\"",2,1200,87,
   18601034940636579559,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.7715604845694313`*^9, 3.7715605602029867`*^9}},
 CellLabel->
  "During evaluation of \
In[1200]:=",ExpressionUUID->"3ec3093f-a820-4448-84e7-c1b8bd937822"],

Cell[BoxData["1.0000000098480597`"], "Output",
 CellChangeTimes->{
  3.771560230455275*^9, 3.7715604141727057`*^9, {3.77156046414501*^9, 
   3.7715605602085752`*^9}},
 CellLabel->
  "Out[1200]=",ExpressionUUID->"be49e220-8d22-47d2-9ff3-64bc6700ef34"]
}, Open  ]]
},
WindowSize->{960, 1016},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 21695, 445, 1137, "Input",ExpressionUUID->"bd3a6917-c163-4fef-bfea-4c9e4698f825",
 InitializationCell->True],
Cell[22278, 469, 1032, 20, 40, "Output",ExpressionUUID->"45c4b3ae-098e-4717-8c4b-5d5b7acf61cd"]
}, Open  ]],
Cell[23325, 492, 2098, 53, 232, "Input",ExpressionUUID->"c1d64f98-a939-4d48-9322-369ba8ac9a70",
 InitializationCell->True],
Cell[25426, 547, 13279, 254, 991, "Input",ExpressionUUID->"f81457cf-540f-4fd6-8fbe-e0b7b50f8de7",
 InitializationCell->True],
Cell[38708, 803, 5084, 126, 554, "Input",ExpressionUUID->"4659c3bb-76d2-4cb7-8829-d708c404456d",
 InitializationCell->True],
Cell[43795, 931, 20856, 444, 1930, "Input",ExpressionUUID->"fcbc698c-9253-4e7a-8455-49e75945367b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[64676, 1379, 2790, 65, 347, "Input",ExpressionUUID->"2922660b-c89a-4813-a226-5bbe6d945c59",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[67491, 1448, 1238, 24, 90, "Print",ExpressionUUID->"a6ee4ad9-4cac-4a44-850d-203e6f9deb76"],
Cell[68732, 1474, 1127, 21, 25, "Print",ExpressionUUID->"908d4fd3-c907-428f-8f7e-3293eb7cd6af"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69908, 1501, 7377, 185, 726, "Input",ExpressionUUID->"275a486c-697d-43e9-ab2b-329ebe12e447"],
Cell[77288, 1688, 263, 3, 35, "Output",ExpressionUUID->"8c659ed4-30f2-4d6b-88df-d95ac9310e56"],
Cell[77554, 1693, 266, 3, 35, "Output",ExpressionUUID->"ae704be1-c4b4-41d6-9b7e-ad05c0a65bef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77857, 1701, 989, 21, 59, "Input",ExpressionUUID->"9351ed12-7904-4feb-b19d-ff7c1d8647df"],
Cell[78849, 1724, 977, 18, 53, "Message",ExpressionUUID->"b0d65828-b46b-4c51-9700-8b799a0cacce"],
Cell[79829, 1744, 976, 18, 53, "Message",ExpressionUUID->"d5c9770e-a786-429a-8138-8630317d8c75"],
Cell[80808, 1764, 514, 8, 37, "Output",ExpressionUUID->"680cbf3c-64ec-488c-808a-4fd1c36f281d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81359, 1777, 1005, 24, 69, "Input",ExpressionUUID->"e31cc252-d4d5-4800-ba90-7f83c28bea11"],
Cell[82367, 1803, 685, 13, 32, "Message",ExpressionUUID->"916a6389-fd42-4afe-9ff1-06dabfeab836"],
Cell[83055, 1818, 903, 18, 91, "Message",ExpressionUUID->"3ec3093f-a820-4448-84e7-c1b8bd937822"],
Cell[83961, 1838, 250, 5, 35, "Output",ExpressionUUID->"be49e220-8d22-47d2-9ff3-64bc6700ef34"]
}, Open  ]]
}
]
*)

